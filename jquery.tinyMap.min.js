(function(h,t,z,q){function g(b,a){try{return t.hasOwnProperty?b.hasOwnProperty(a.toString()):Object.prototype.hasOwnProperty.call(b,a.toString())}catch(c){console.dir(c)}}function p(b,a){var c=[],d=/^[+-]?\d+(\.\d+)?$/,e={lat:"",lng:""};if("string"===typeof b||h.isArray(b))if(c="string"===typeof b?b.replace(/\s+/,"").split(","):b,2===c.length)d.test(c[0])&&d.test(c[1])&&(e.lat=c[0],e.lng=c[1]);else return b;else if("object"===typeof b){if("function"===typeof b.lat||"function"===typeof b.lng)return b;
g(b,"x")&&g(b,"y")?(e.lat=b.x,e.lng=b.y):g(b,"lat")&&g(b,"lng")&&(e.lat=b.lat,e.lng=b.lng)}return q!==a&&!0===a?new google.maps.LatLng(e.lat,e.lng):e}function r(b){var a=b.css||"";this.setValues(b);this.span=h("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(a);this.div=h("<div/>").css({position:"absolute",display:"none"});this.span.appendTo(this.div)}function u(b,a){var c={};g(t,"google")&&(c=h.extend({},y,a),this.markerCluster=this.map=null,this._markers=
[],this._labels=[],this.container=b,this.options=c,this.interval=parseInt(this.options.interval,10)||200,this.googleMapOptions={center:"",control:c.control,disableDoubleClickZoom:c.disableDoubleClickZoom,disableDefaultUI:c.disableDefaultUI,draggable:c.draggable,keyboardShortcuts:c.keyboardShortcuts,mapTypeId:google.maps.MapTypeId[c.mapTypeId.toUpperCase()],mapTypeControl:c.mapTypeControl,mapTypeControlOptions:{position:google.maps.ControlPosition[c.mapTypeControlOptions.position],style:google.maps.MapTypeControlStyle[c.mapTypeControlOptions.style.toUpperCase()]},
maxZoom:c.maxZoom,minZoom:c.minZoom,navigationControl:c.navigationControl,navigationControlOptions:{position:google.maps.ControlPosition[c.navigationControlOptions.position],style:google.maps.NavigationControlStyle[c.navigationControlOptions.style.toUpperCase()]},panControl:c.panControl,panControlOptions:{position:google.maps.ControlPosition[c.panControlOptions.position]},rotateControl:c.rotateControl,scaleControl:c.scaleControl,scaleControlOptions:{position:google.maps.ControlPosition[c.scaleControlOptions.position],
style:google.maps.ScaleControlStyle[c.scaleControlOptions.style.toUpperCase()]},scrollwheel:c.scrollwheel,streetViewControl:c.streetViewControl,streetViewControlOptions:{position:google.maps.ControlPosition[c.streetViewControlOptions.position]},zoom:c.zoom,zoomControl:c.zoomControl,zoomControlOptions:{position:google.maps.ControlPosition[c.zoomControlOptions.position],style:google.maps.ZoomControlStyle[c.zoomControlOptions.style.toUpperCase()]}},this.options.center=this.googleMapOptions.center=p(c.center,
!0),!0===c.disableDefaultUI&&(this.googleMapOptions.mapTypeControl=!1,this.googleMapOptions.navigationControl=!1,this.googleMapOptions.panControl=!1,this.googleMapOptions.rotateControl=!1,this.googleMapOptions.scaleControl=!1,this.googleMapOptions.streetViewControl=!1,this.googleMapOptions.zoomControl=!1),g(c,"styles")&&("string"===typeof c.styles?g(v,c.styles)&&(this.googleMapOptions.styles=v[c.styles]):h.isArray(c.styles)&&(this.googleMapOptions.styles=c.styles)),h(this.container).html(c.loading),
this.init())}var y={center:{lat:"",lng:""},control:!0,disableDoubleClickZoom:!1,disableDefaultUI:!1,draggable:!0,infoWindowAutoClose:!0,keyboardShortcuts:!0,mapTypeControl:!0,mapTypeControlOptions:{position:"TOP_RIGHT",style:"DEFAULT"},mapTypeId:"ROADMAP",marker:[],markerFitBounds:!1,markerCluster:!1,maxZoom:null,minZoom:null,panControl:!0,panControlOptions:{position:"LEFT_TOP"},polyline:[],navigationControl:!0,navigationControlOptions:{position:"TOP_LEFT",style:"DEFAULT"},scaleControl:!0,scaleControlOptions:{position:"BOTTOM_LEFT",
style:"DEFAULT"},scrollwheel:!0,streetViewControl:!0,streetViewControlOptions:{position:"LEFT_TOP"},zoom:4,zoomControl:!0,zoomControlOptions:{style:"LARGE",position:"LEFT_TOP"},notfound:"\u627e\u4e0d\u5230\u67e5\u8a62\u7684\u5730\u9ede",loading:"\u8b80\u53d6\u4e2d&hellip;",kml:{url:"",viewport:!0,infowindow:!1},interval:200,event:null,streetView:{},autoLocation:!1},w=0,x=0,v={},v={greyscale:[{featureType:"all",stylers:[{saturation:-100},{gamma:.5}]}]};r.prototype=new google.maps.OverlayView;r.prototype.onAdd=
function(){this.div.appendTo(h(this.getPanes().overlayLayer));this.listeners=[google.maps.event.addListener(this,"visible_changed",this.onRemove)]};r.prototype.draw=function(){var b=this.getProjection(),a={};try{a=b.fromLatLngToDivPixel(this.get("position")),this.div.css({left:a.x+"px",top:a.y+"px",display:"block"}),this.text&&this.span.html(this.text.toString())}catch(c){}};r.prototype.onRemove=function(){h(this.div).remove()};u.prototype={VERSION:"2.9.6",_polylines:[],_polygons:[],_circles:[],_kmls:[],
_directions:[],_directionsMarkers:[],bounds:new google.maps.LatLngBounds,setZoom:function(b,a){g(a,"zoom")&&"function"===typeof b.setZoom&&b.setZoom(a.zoom)},kml:function(b,a){var c={},d={preserveViewport:!1,suppressInfoWindows:!1},e=0;if(g(a,"kml"))if("string"===typeof a.kml)c=new google.maps.KmlLayer(a.kml,d),c.setMap(b),this._kmls.push(c);else if(h.isArray(a.kml))for(e=0;e<a.kml.length;e+=1)"string"===typeof a.kml[e]&&(c=new google.maps.KmlLayer(a.kml[e],d),c.setMap(b),this._kmls.push(c))},direction:function(b,
a){if(g(a,"direction")&&h.isArray(a.direction))for(var c=0;c<a.direction.length;c+=1)this.directionService(a.direction[c])},markers:function(b,a,c){var d={},e=0,f=0,k=d=0,l=[],m=[];x=w=0;l=this._markers;if(!c||0===l.length&&h.isArray(a.marker))for(f=0,e=a.marker.length;f<e;f+=1)d=a.marker[f],g(d,"addr")&&(d.parseAddr=p(d.addr,!0),"string"===typeof d.parseAddr?this.markerByGeocoder(b,d,a):this.markerDirect(b,d,a));if("modify"===c)for(m=this._labels,f=0,e=a.marker.length;f<e;f+=1)if(g(a.marker[f],"id")){for(d=
0;d<l.length;d+=1)a.marker[f].id===l[d].id&&g(a.marker[f],"addr")&&(l[d].setPosition(new google.maps.LatLng(a.marker[f].addr[0],a.marker[f].addr[1])),g(a.marker[f],"text")&&(g(l[d],"infoWindow")?"function"===typeof l[d].infoWindow.setContent&&l[d].infoWindow.setContent(a.marker[f].text):(l[d].infoWindow=new google.maps.InfoWindow({content:a.marker[f].text}),this.bindEvents(l[d],a.marker[f].event))),g(a.marker[f],"icon")&&l[d].setIcon(a.marker[f].icon));d=0;for(k=m.length;d<k;d+=1)a.marker[f].id===
m[d].id&&(g(a.marker[f],"label")&&(m[d].text=a.marker[f].label),m[d].draw())}else g(a.marker[f],"addr")&&(a.marker[f].parseAddr=p(a.marker[f].addr,!0),"string"===typeof a.marker[f].parseAddr?this.markerByGeocoder(b,a.marker[f]):this.markerDirect(b,a.marker[f]));if(g(a,"markerCluster")&&!0===a.markerCluster&&"function"===typeof MarkerClusterer)return new MarkerClusterer(b,this._markers)},drawPolyline:function(b,a){var c={},d=0,e={},e={},f=0,k=new google.maps.MVCArray,l=[],e={},m=[],s={};if(g(a,"polyline")&&
g(a.polyline,"coords")&&h.isArray(a.polyline.coords)){for(d=0;d<a.polyline.coords.length;d+=1)e=a.polyline.coords[d],e=p(e,!0),"function"===typeof e.lat&&k.push(e);c=new google.maps.Polyline({strokeColor:a.polyline.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polyline.width||2});this._polylines.push(c);if(2<k.getLength())for(d=0;d<k.length;d+=1)0<d&&k.length-1>d&&m.push({location:k.getAt(d),stopover:!1});g(a.polyline,"snap")&&!0===a.polyline.snap?(e=new google.maps.DirectionsService,e.route({origin:k.getAt(0),
waypoints:m,destination:k.getAt(k.length-1),travelMode:google.maps.DirectionsTravelMode.DRIVING},function(b,e){if(e===google.maps.DirectionsStatus.OK){d=0;for(f=b.routes[0].overview_path;d<f.length;d+=1)l.push(f[d]);c.setPath(l);"function"===typeof a.polyline.getDistance&&(s=b.routes[0].legs[0].distance,a.polyline.getDistance.call(this,s))}})):(c.setPath(k),g(google.maps.geometry,"spherical")&&"function"===typeof google.maps.geometry.spherical.computeDistanceBetween&&(s=google.maps.geometry.spherical.computeDistanceBetween(k.getAt(0),
k.getAt(k.length-1)),"function"===typeof a.polyline.getDistance&&a.polyline.getDistance.call(this,s)));c.setMap(b)}},drawPolygon:function(b,a){var c={},c=0,d={},d={},e=[];if(g(a,"polygon")&&g(a.polygon,"coords")&&h.isArray(a.polygon.coords)){for(c=0;c<a.polygon.coords.length;c+=1)d=a.polygon.coords[c],d=p(d,!0),"function"===typeof d.lat&&e.push(d);c=new google.maps.Polygon({path:e,strokeColor:a.polygon.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polygon.width||2,fillColor:a.polygon.fillcolor||
"#CC0000",fillOpacity:.35});this._polygons.push(c);c.setMap(this.map);g(a.polygon,"click")&&"function"===typeof a.polygon.click&&google.maps.event.addListener(c,"click",a.polygon.click)}},drawCircle:function(b,a){var c=0,d={},e={},e={};if(g(a,"circle")&&h.isArray(a.circle))for(c=a.circle.length-1;0<=c;c-=1)e=a.circle[c],g(e,"center")&&(d=p(e.center,!0)),"function"===typeof d.lat&&(e=new google.maps.Circle({strokeColor:e.color||"#FF0000",strokeOpacity:e.opacity||.8,strokeWeight:e.width||2,fillColor:e.fillcolor||
"#FF0000",fillOpacity:e.fillopacity||.35,map:this.map,center:d,radius:e.radius||10,zIndex:100,id:g(a,"id")?a.id:""}),this._circles.push(e),"function"===typeof a.circle[c].click&&google.maps.event.addListener(e,"click",a.circle[c].click))},overlay:function(){var b=this.map,a=this.options;this.kml(b,a);this.direction(b,a);this.markers(b,a);this.drawPolyline(b,a);this.drawPolygon(b,a);this.drawCircle(b,a);this.streetView(b,a);this.geoLocation(b,a)},markerIcon:function(b){var a=h.extend({},a,b.icon);
if(g(b,"icon")){if("string"===typeof b.icon)return b.icon;g(b.icon,"url")&&(a.url=b.icon.url);g(b.icon,"size")&&h.isArray(b.icon.size)&&2===b.icon.size.length&&(a.size=new google.maps.Size(b.icon.size[0],b.icon.size[1]));g(b.icon,"scaledSize")&&h.isArray(b.icon.scaledSize)&&2===b.icon.scaledSize.length&&(a.scaledSize=new google.maps.Size(b.icon.scaledSize[0],b.icon.scaledSize[1]));g(b.icon,"anchor")&&h.isArray(b.icon.anchor)&&2===b.icon.anchor.length&&(a.anchor=new google.maps.Point(b.icon.anchor[0],
b.icon.anchor[1]));g(b.icon,"path")&&"string"===typeof b.icon.path&&(a.path=google.maps.SymbolPath[b.icon.path])}return a},markerDirect:function(b,a){var c={},d={},d={},d=g(a,"id")?a.id:"",c=g(a,"title")?a.title.toString().replace(/<([^>]+)>/g,""):!1,e=g(a,"text")?a.text.toString():!1,f={map:b,position:a.parseAddr,animation:null,id:d},k=this.markerIcon(a);c&&(f.title=c);e&&(f.text=e,f.infoWindow=new google.maps.InfoWindow({content:e}));f.icon=k;g(a,"animation")&&"string"===typeof a.animation&&(f.animation=
google.maps.Animation[a.animation.toUpperCase()]);c=new google.maps.Marker(f);this._markers.push(c);g(c,"position")&&("function"===typeof c.getPosition&&this.bounds.extend(c.position),!0===this.options.markerFitBounds&&this._markers.length===this.options.marker.length&&b.fitBounds(this.bounds));if(!0===this.options.markerCluster&&"function"===typeof MarkerClusterer&&w===this.options.marker.length)return new MarkerClusterer(b,this._markers);d={map:b,css:g(a,"css")?a.css.toString():"",id:d};"string"===
typeof a.label&&0!==a.label.length&&(d.text=a.label,d=new r(d),d.bindTo("position",c,"position"),d.bindTo("text",c,"position"),d.bindTo("visible",c),this._labels.push(d));this.bindEvents(c,a.event)},markerByGeocoder:function(b,a){var c=this;(new google.maps.Geocoder).geocode({address:a.parseAddr},function(d,e){if(e===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)t.setTimeout(function(){c.markerByGeocoder(b,a)},c.interval);else if(e===google.maps.GeocoderStatus.OK){var f={},k={},k={},h=g(a,"id")?a.id:
"",f=g(a,"title")?a.title.toString().replace(/<([^>]+)>/g,""):!1,k=g(a,"text")?a.text.toString():!1,h={map:b,position:d[0].geometry.location,animation:null,id:h},m=c.markerIcon(a);f&&(h.title=f);k&&(h.text=k,h.infoWindow=new google.maps.InfoWindow({content:k}));h.icon=m;g(a,"animation")&&"string"===typeof a.animation&&(h.animation=google.maps.Animation[a.animation.toUpperCase()]);f=new google.maps.Marker(h);c._markers.push(f);g(f,"position")&&"function"===typeof f.getPosition&&c.bounds.extend(h.position);
!0===c.options.markerFitBounds&&c._markers.length===c.options.marker.length&&b.fitBounds(c.bounds);if(g(c.options,"markerCluster")&&"function"===typeof MarkerClusterer&&x===c.options.marker.length)return new MarkerClusterer(b,c._markers);k={map:c.map,css:g(a,"css")?a.css.toString():""};"string"===typeof a.label&&0!==a.label.length&&(k.text=a.label,k=new r(k),k.bindTo("position",f,"position"),k.bindTo("text",f,"position"),k.bindTo("visible",f),c._labels.push(k));c.bindEvents(f,a.event)}})},directionService:function(b){var a=
this,c=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer,e={travelMode:google.maps.DirectionsTravelMode.DRIVING,optimizeWaypoints:b.optimize||!1},f={},k={},l=[],m={},s=[],q={},r="",n=0,t=0;e.origin=p(b.from,!0);e.destination=p(b.to,!0);g(b,"travel")&&google.maps.TravelMode[b.travel.toString().toUpperCase()]&&(e.travelMode=google.maps.TravelMode[b.travel.toString().toUpperCase()]);g(b,"panel")&&(f=h(b.panel));if(g(b,"waypoint")&&h.isArray(b.waypoint)){n=0;for(t=b.waypoint.length;n<
t;n+=1)m={},"string"===typeof b.waypoint[n]||h.isArray(b.waypoint[n])?m={location:p(b.waypoint[n],!0),stopover:!0}:(g(b.waypoint[n],"location")&&(m.location=p(b.waypoint[n].location,!0)),m.stopover=g(b.waypoint[n],"stopover")?b.waypoint[n].stopover:!0),s.push(b.waypoint[n].text||b.waypoint[n].toString()),l.push(m);e.waypoints=l}c.route(e,function(c,e){var f=0,h=0;if(e===google.maps.DirectionsStatus.OK){f=c.routes[0].legs;g(b,"autoViewport")&&(k.preserveViewport=!1===b.autoViewport?!0:!1);try{for(g(b,
"fromText")&&(f[0].start_address=b.fromText),g(b,"toText")&&(1===f.length?f[0].end_address=b.toText:f[f.length-1].end_address=b.toText),1===f.length?(q=f[0].end_location,r=f[0].end_address):(q=f[f.length-1].end_location,r=f[f.length-1].end_address),g(b,"icon")&&(k.suppressMarkers=!0,g(b.icon,"from")&&"string"===typeof b.icon.from&&a.directionServiceMarker(f[0].start_location,{icon:b.icon.from,text:f[0].start_address}),g(b.icon,"to")&&"string"===typeof b.icon.to&&a.directionServiceMarker(q,{icon:b.icon.to,
text:r})),h=1;h<f.length;h+=1)f[h].start_address=s[h-1],g(b,"icon")&&g(b.icon,"waypoint")&&a.directionServiceMarker(f[h].start_location,{icon:b.icon.waypoint,text:f[h].start_address})}catch(l){}a.bindEvents(d,b.event);d.setOptions(k);d.setDirections(c)}});d.setMap(a.map);f.length&&d.setPanel(f.get(0));a._directions.push(d)},directionServiceMarker:function(b,a){var c=h.extend({},{position:b,map:this.map},a),d={};g(c,"text")&&(c.infoWindow=new google.maps.InfoWindow({content:c.text}));d=new google.maps.Marker(c);
this._directionsMarkers.push(d);this.bindEvents(d)},bindEvents:function(b,a){var c=this,d={};switch(typeof a){case "function":google.maps.event.addListener(b,"click",a);break;case "object":for(d in a)"function"===typeof a[d]?google.maps.event.addListener(b,d,a[d]):g(a[d],"func")&&"function"===typeof a[d].func?g(a[d],"once")&&!0===a[d].once?google.maps.event.addListenerOnce(b,d,a[d].func):google.maps.event.addListener(b,d,a[d].func):"function"===typeof a[d]&&google.maps.event.addListener(b,d,a[d])}g(b,
"infoWindow")&&google.maps.event.addListener(b,"click",function(){var a=0,d={};if(g(c.options,"infoWindowAutoClose")&&!0===c.options.infoWindowAutoClose)for(a=0;a<c._markers.length;a+=1)d=c._markers[a],g(d,"infoWindow")&&"function"===typeof d.infoWindow.close&&d.infoWindow.close();b.infoWindow.open(c.map,b)})},streetView:function(b,a){var c={},d=g(a,"streetView")?a.streetView:{},e={heading:0,pitch:0,zoom:1},f="closeclick links_changed pano_changed position_changed pov_changed resize status_changed visible_changed zoom_changed".split(" "),
k=0,k={};if("function"===typeof b.getStreetView&&g(a,"streetView")&&(c=b.getStreetView(),g(d,"position")?(k=p(d.position,!0),d.position="object"!==typeof k?b.getCenter():k):d.position=b.getCenter(),g(d,"pov")&&(d.pov=h.extend({},e,d.pov)),g(d,"visible")&&c.setVisible(d.visible),c.setOptions(d),g(d,"events")))for(k=0;k<f.length;k+=1)g(d.events,f[k])&&this.bindEvents(c,d.events[f[k]])},panto:function(b){var a={},a={},c=this.map;null!==c&&q!==c&&(a=p(b,!0),"string"===typeof b?(a=new google.maps.Geocoder,
a.geocode({address:b},function(a,b){b===google.maps.GeocoderStatus.OK?"function"===typeof c.panTo&&a.length&&c.panTo(a[0].geometry.location):console.error(b)})):"function"===typeof c.panTo&&c.panTo(a))},clear:function(b){for(var a=[],c="",d=0,e=0,a="string"===typeof b?b.split(","):h.isArray(b)?b:"marker circle polygon polyline direction kml".split(" "),d=0;d<a.length;d+=1){c="_"+h.trim(a[d].toString().toLowerCase())+"s";if(q!==this[c]&&this[c].length){for(e=0;e<this[c].length;e+=1)this.map===this[c][e].getMap()&&
(this[c][e].set("visible",!1),this[c][e].set("directions",null),this[c][e].setMap(null));this[c].length=0}if("direction"===a[d])for(e=0;e<this._directionsMarkers.length;e+=1)this._directionsMarkers[e].setMap(null)}},modify:function(b){var a=[],c=[["kml","kml"],["marker","markers"],["direction","direction"],["polyline","drawPolyline"],["polygon","drawPolygon"],["circle","drawCircle"],["zoom","setZoom"],["streetView","streetView"]],d=0,e=this.map;if(q!==b){for(d=0;d<c.length;d+=1)g(b,c[d][0])&&a.push(c[d][1]);
if(null!==e){if(a.length)for(d=0;d<a.length;d+=1){if("function"===typeof this[a[d]])this[a[d]](e,b,"modify")}else e.setOptions(b);g(b,"event")&&this.bindEvents(e,b.event)}}},destroy:function(){var b=h(this.container);h.data(b.get(0),"tinyMap",null);if(b.length)return b.empty()},geoLocation:function(b,a){var c=navigator.geolocation;c&&!0===a.autoLocation&&c.getCurrentPosition(function(a){a&&g(a,"coords")&&b.panTo(new google.maps.LatLng(a.coords.latitude,a.coords.longitude))},function(a){console.error(a)},
{maximumAge:6E5,timeout:3E3,enableHighAccuracy:!1})},init:function(){var b=this,a={};"string"===typeof b.options.center?(a=new google.maps.Geocoder,a.geocode({address:b.options.center},function(a,d){try{d===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?b.init():d===google.maps.GeocoderStatus.OK&&0!==a.length?q!==a[0]&&g(a[0],"geometry")&&(b.googleMapOptions.center=a[0].geometry.location,b.map=new google.maps.Map(b.container,b.googleMapOptions),google.maps.event.addListenerOnce(b.map,"idle",function(){b.overlay()}),
b.bindEvents(b.map,b.options.event)):console.error(d)}catch(e){console.error(e)}})):(b.map=new google.maps.Map(b.container,b.googleMapOptions),google.maps.event.addListenerOnce(b.map,"idle",function(){b.overlay()}),b.bindEvents(b.map,b.options.event))}};h.fn.tinyMap=function(b){var a=arguments,c=[],d={};return"string"===typeof b?(this.each(function(){d=h.data(this,"tinyMap");d instanceof u&&"function"===typeof d[b]&&(c=d[b].apply(d,Array.prototype.slice.call(a,1)))}),q!==c?c:this):this.each(function(){h.data(this,
"tinyMap")||h.data(this,"tinyMap",new u(this,b))})}})(jQuery,window,document);
