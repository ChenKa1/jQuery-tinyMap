(function(g,q,t,f){function e(b,a){try{return q.hasOwnProperty?b.hasOwnProperty(a.toString()):Object.prototype.hasOwnProperty.call(b,a.toString())}catch(c){}}function m(b){var a=b.css||"";this.setValues(b);this.span=g("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(a);this.div=g("<div/>").css({position:"absolute",display:"none"});this.span.appendTo(this.div)}function r(b,a){e(q,"google")&&(this.markerCluster=this.map=null,this._markers=[],this.container=b,
this.options=g.extend({},s,a),this.interval=parseInt(this.options.interval,10)||200,this.GoogleMapOptions={center:new google.maps.LatLng(this.options.center.x,this.options.center.y),control:this.options.control,disableDoubleClickZoom:this.options.disableDoubleClickZoom,disableDefaultUI:this.options.disableDefaultUI,draggable:this.options.draggable,keyboardShortcuts:this.options.keyboardShortcuts,mapTypeId:google.maps.MapTypeId[this.options.mapTypeId.toUpperCase()],mapTypeControl:this.options.mapTypeControl,
mapTypeControlOptions:{position:google.maps.ControlPosition[this.options.mapTypeControlOptions.position],style:google.maps.MapTypeControlStyle[this.options.mapTypeControlOptions.style.toUpperCase()]},maxZoom:this.options.maxZoom,minZoom:this.options.minZoom,navigationControl:this.options.navigationControl,navigationControlOptions:{position:google.maps.ControlPosition[this.options.navigationControlOptions.position],style:google.maps.NavigationControlStyle[this.options.navigationControlOptions.style.toUpperCase()]},
panControl:this.options.panControl,panControlOptions:{position:google.maps.ControlPosition[this.options.panControlOptions.position]},rotateControl:this.options.rotateControl,scaleControl:this.options.scaleControl,scaleControlOptions:{position:google.maps.ControlPosition[this.options.scaleControlOptions.position],style:google.maps.ScaleControlStyle[this.options.scaleControlOptions.style.toUpperCase()]},scrollwheel:this.options.scrollwheel,streetViewControl:this.options.streetViewControl,streetViewControlOptions:{position:google.maps.ControlPosition[this.options.streetViewControlOptions.position]},
zoom:this.options.zoom,zoomControl:this.options.zoomControl,zoomControlOptions:{position:google.maps.ControlPosition[this.options.zoomControlOptions.position],style:google.maps.ZoomControlStyle[this.options.zoomControlOptions.style.toUpperCase()]}},!0===this.options.disableDefaultUI&&(this.GoogleMapOptions.mapTypeControl=!1,this.GoogleMapOptions.navigationControl=!1,this.GoogleMapOptions.panControl=!1,this.GoogleMapOptions.rotateControl=!1,this.GoogleMapOptions.scaleControl=!1,this.GoogleMapOptions.streetViewControl=
!1,this.GoogleMapOptions.zoomControl=!1),g(this.container).html(this.options.loading),this.init())}var s={center:{x:"24",y:"121"},control:!0,disableDoubleClickZoom:!1,disableDefaultUI:!1,draggable:!0,keyboardShortcuts:!0,mapTypeControl:!0,mapTypeControlOptions:{position:"TOP_RIGHT",style:"DEFAULT"},mapTypeId:"ROADMAP",marker:[],markerFitBounds:!1,markerCluster:!1,maxZoom:null,minZoom:null,panControl:!0,panControlOptions:{position:"LEFT_TOP"},polyline:[],navigationControl:!0,navigationControlOptions:{position:"TOP_LEFT",
style:"DEFAULT"},scaleControl:!0,scaleControlOptions:{position:"BOTTOM_LEFT",style:"DEFAULT"},scrollwheel:!0,streetViewControl:!0,streetViewControlOptions:{position:"LEFT_TOP"},zoom:4,zoomControl:!0,zoomControlOptions:{style:"LARGE",position:"LEFT_TOP"},notfound:"\u627e\u4e0d\u5230\u67e5\u8a62\u7684\u5730\u9ede",loading:"\u8b80\u53d6\u4e2d&hellip;",kml:{url:"",viewport:!0,infowindow:!1},interval:200,event:null},n=0,p=0;m.prototype=new google.maps.OverlayView;m.prototype.onAdd=function(){var b=this.getPanes().overlayLayer;
this.div.appendTo(g(b));this.listeners=[google.maps.event.addListener(this,"visible_changed",this.onRemove)]};m.prototype.draw=function(){var b=this.getProjection().fromLatLngToDivPixel(this.get("position"));this.div.css({left:b.x+"px",top:b.y+"px",display:"block"});this.text&&this.span.html(this.text.toString())};m.prototype.onRemove=function(){g(this.div).remove()};r.prototype={VERSION:"2.7.0",_labels:[],_polylines:[],_polygons:[],_circles:[],_kmls:[],_directions:[],bounds:new google.maps.LatLngBounds,
setZoom:function(b,a){e(a,"zoom")&&b&&b.setZoom(a.zoom)},kml:function(b,a){var c={},d="",c={};a=a?a:this.options;f!==a.kml&&(c={preserveViewport:!0,suppressInfoWindows:!1},d="string"===typeof a.kml&&0!==a.kml.length?a.kml:f!==a.kml.url?a.kml.url:"",c=new google.maps.KmlLayer(d,g.extend(c,a.kml)),this._kmls.push(c),c.setMap(b))},direction:function(b,a){var c="";a=a?a:this.options;if(f!==a.direction&&0<a.direction.length)for(c in a.direction)e(a.direction,c)&&f!==a.direction[c]&&this.directionService(a.direction[c])},
markers:function(b,a){var c="";a=a?a:this.options;p=n=0;if(f!==a.marker&&0<a.marker.length)for(c in a.marker)e(a.marker,c)&&e(a.marker[c],"addr")&&("object"===typeof a.marker[c].addr&&2===a.marker[c].addr.length?this.markerDirect(b,a.marker[c]):"string"===typeof a.marker[c].addr&&this.markerByGeocoder(b,a.marker[c]))},drawPolyline:function(b,a){var c={},c="",d={},l=[];a=a?a:this.options;if(f!==a.polyline&&f!==a.polyline.coords){for(c in a.polyline.coords)e(a.polyline.coords,c)&&(d=a.polyline.coords,
f!==d[c]&&l.push(new google.maps.LatLng(d[c][0],d[c][1])));c=new google.maps.Polyline({path:l,strokeColor:a.polyline.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polyline.width||2});this._polylines.push(c);c.setMap(b)}},drawPolygon:function(b,a){var c={},c="",d={},l=[];a=a?a:this.options;if(f!==a.polygon&&f!==a.polygon.coords){for(c in a.polygon.coords)e(a.polygon.coords,c)&&(d=a.polygon.coords,f!==d[c]&&l.push(new google.maps.LatLng(d[c][0],d[c][1])));c=new google.maps.Polygon({path:l,strokeColor:a.polygon.color||
"#FF0000",strokeOpacity:1,strokeWeight:a.polygon.width||2,fillColor:a.polygon.fillcolor||"#CC0000",fillOpacity:.35});this._polygons.push(c);c.setMap(this.map);g.isFunction(a.polygon.click)&&google.maps.event.addListener(c,"click",a.polygon.click)}},drawCircle:function(b,a){var c=0,d={},d={};a=a?a:this.options;if(f!==a.circle&&0<a.circle.length)for(c=a.circle.length-1;0<=c;c-=1)d=a.circle[c],f!==d.center.x&&f!==d.center.y&&(d=new google.maps.Circle({strokeColor:d.color||"#FF0000",strokeOpacity:d.opacity||
.8,strokeWeight:d.width||2,fillColor:d.fillcolor||"#FF0000",fillOpacity:d.fillopacity||.35,map:this.map,center:new google.maps.LatLng(d.center.x,d.center.y),radius:d.radius||10,zIndex:100}),this._circles.push(d),g.isFunction(a.circle[c].click)&&google.maps.event.addListener(d,"click",a.circle[c].click))},overlay:function(){var b=this.map,a=this.options;this.kml(b,a);this.direction(b,a);this.markers(b,a);this.drawPolyline(b,a);this.drawPolygon(b,a);this.drawCircle(b,a)},markerIcon:function(b){var a=
{};if(e(b,"icon")){if("string"===typeof b.icon)return b.icon;e(b.icon,"url")&&(a.url=b.icon.url);e(b.icon,"size")&&f!==b.icon.size[0]&&f!==b.icon.size[1]&&(a.scaledSize=new google.maps.Size(b.icon.size[0],b.icon.size[1]));e(b.icon,"anchor")&&f!==b.icon.anchor[0]&&f!==b.icon.anchor[1]&&(a.anchor=new google.maps.Point(b.icon.anchor[0],b.icon.anchor[1]))}return a},markerDirect:function(b,a){var c={},d={},d={},c=e(a,"title")?a.title.toString().replace(/<([^>]+)>/g,""):"",d=e(a,"text")?a.text.toString():
"",d={map:b,position:new google.maps.LatLng(a.addr[0],a.addr[1]),infoWindow:new google.maps.InfoWindow({content:d}),animation:null},l=this.markerIcon(a);c&&(d.title=c);n+=1;if("string"===typeof l||e(l,"url"))d.icon=l;e(a.animation)&&"string"===typeof a.animation&&(d.animation=google.maps.Animation[a.animation.toUpperCase()]);c=new google.maps.Marker(d);this._markers.push(c);if(e(c,"position")&&(c.getPosition().lat()&&c.getPosition().lng()&&this.bounds.extend(d.position),!0===this.options.markerFitBounds&&
n===this.options.marker.length))return b.fitBounds(this.bounds);!0===this.options.markerCluster&&"function"===typeof MarkerClusterer&&n===this.options.marker.length?this.markerCluster=new MarkerClusterer(b,this._markers):(d={map:b,css:f!==a.css?a.css:""},"string"===typeof a.label&&0!==a.label.length&&(d.text=a.label),d=new m(d),d.bindTo("position",c,"position"),d.bindTo("text",c,"position"),d.bindTo("visible",c),this.bindEvents(c,a.event))},markerByGeocoder:function(b,a){var c=new google.maps.Geocoder,
d=this;-1!==a.addr.indexOf(",")&&(a.addr="loc: "+a.addr);c.geocode({address:a.addr},function(c,f){if(f===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)q.setTimeout(function(){d.markerByGeocoder(a)},d.interval);else if(f===google.maps.GeocoderStatus.OK){var h={},k={},k={},h=e(a,"title")?a.title.toString().replace(/<([^>]+)>/g,""):"",k=e(a,"text")?a.text.toString():"",k={map:b,position:c[0].geometry.location,title:h,infoWindow:new google.maps.InfoWindow({content:k}),animation:null},g=d.markerIcon(a);
h&&(k.title=h);p+=1;if("string"===typeof g||e(g,"url"))k.icon=g;e(a,"animation")&&"string"===typeof a.animation&&(k.animation=google.maps.Animation[a.animation.toUpperCase()]);h=new google.maps.Marker(k);d._markers.push(h);e(h,"position")&&h.getPosition().lat()&&h.getPosition().lng()&&d.bounds.extend(k.position);if(!0===d.options.markerFitBounds&&p===d.options.marker.length)return b.fitBounds(d.bounds);e(d.options,"markerCluster")&&"function"===typeof MarkerClusterer&&p===d.options.marker.length?
d.markerCluster=new MarkerClusterer(b,d._markers):(k={map:d.map,css:a.css||""},"string"===typeof a.label&&0!==a.label.length&&(k.text=a.label),k=new m(k),k.bindTo("position",h,"position"),k.bindTo("text",h,"position"),k.bindTo("visible",h),d.bindEvents(h,a.event))}})},directionService:function(b){var a=[],c=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer,l={travelMode:google.maps.DirectionsTravelMode.DRIVING,optimizeWaypoints:b.optimize||!1},e={},h=0,k=0;"string"===typeof b.from&&
(l.origin=b.from);"string"===typeof b.to&&(l.destination=b.to);"string"===typeof b.travel&&b.travel.length&&(l.travelMode=google.maps.TravelMode[b.travel.toUpperCase()]);e=g(f!==b.panel?b.panel:null);if(f!==b.waypoint&&0!==b.waypoint){h=0;for(k=b.waypoint.length;h<k;h+=1)a.push({location:b.waypoint[h].toString(),stopover:!0});l.waypoints=a}f!==l.origin&&f!==l.destination&&(c.route(l,function(a,b){b===google.maps.DirectionsStatus.OK&&d.setDirections(a)}),d.setMap(this.map),e.length&&d.setPanel(e.get(0)),
this._directions.push(d))},bindEvents:function(b,a){var c={};switch(typeof a){case "function":google.maps.event.addListener(b,"click",a);break;case "object":for(c in a)"function"===typeof a[c]?google.maps.event.addListener(b,c,a[c]):e(a[c],"func")&&"function"===typeof a[c].func?e(a[c],"once")&&!0===a[c].once?google.maps.event.addListenerOnce(b,c,a[c].func):google.maps.event.addListener(b,c,a[c].func):"function"===typeof a[c]&&google.maps.event.addListener(b,c,a[c])}},init:function(){var b=this,a=
{};"string"===typeof b.options.center?q.setTimeout(function(){var c=g(b.container),d="";-1!==b.options.center.indexOf(",")&&(b.options.center="loc: "+b.options.center);a=new google.maps.Geocoder;a.geocode({address:b.options.center},function(a,e){try{e===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?b.init():e===google.maps.GeocoderStatus.OK&&0!==a.length?(b.GoogleMapOptions.center=e===google.maps.GeocoderStatus.OK&&0!==a.length?a[0].geometry.location:"",b.map=new google.maps.Map(b.container,b.GoogleMapOptions),
google.maps.event.addListenerOnce(b.map,"idle",function(){b.overlay()}),b.bindEvents(b.map,b.options.event)):(d=b.options.notfound.text||e,c.html(d.replace(/</g,"&lt;").replace(/>/g,"&gt;")))}catch(h){c.html((f!==h.message?h.message:h.description).toString())}})},b.interval):(b.map=new google.maps.Map(b.container,b.GoogleMapOptions),google.maps.event.addListenerOnce(b.map,"idle",function(){b.overlay()}),b.bindEvents(b.map,b.options.event))},panto:function(b){var a="",c={},d=this.map;e(this,"map")&&
null!==d&&f!==d&&("string"===typeof b?(-1!==b.indexOf(",")&&(a="loc: "+b),c=new google.maps.Geocoder,c.geocode({address:b},function(a,b){b===google.maps.GeocoderStatus.OK&&g.isFunction(d.panTo)&&f!==a[0]&&d.panTo(a[0].geometry.location)})):("[object Array]"===Object.prototype.toString.call(b)?2===b.length&&(a=new google.maps.LatLng(b[0],b[1])):e(b,"lat")&&e(b,"lng")?a=new google.maps.LatLng(b.lat,b.lng):e(b,"x")&&e(b,"y")&&(a=new google.maps.LatLng(b.x,b.y)),g.isFunction(d.panTo)&&f!==a&&d.panTo(a)))},
clear:function(b){var a=[],c="",d=0,e=0;"string"===typeof b&&(a=b.split(","));for(d=0;d<a.length;d+=1)if(c="_"+g.trim(a[d].toString().toLowerCase())+"s",f!==this[c]&&this[c].length){for(e=0;e<this[c].length;e+=1)this.map===this[c][e].getMap()&&(this[c][e].set("visible",!1),this[c][e].set("directions",null),this[c][e].setMap(null));this[c].length=0}},modify:function(b){var a=[],c=[["kml","kml"],["marker","markers"],["direction","direction"],["polyline","drawPolyline"],["polygon","drawPolygon"],["circle",
"drawCircle"],["zoom","setZoom"]],d=0,g=this.map;if(f!==b){for(d=0;d<c.length;d+=1)e(b,c[d][0])&&a.push(c[d][1]);if(null!==g)if(a.length)for(d=0;d<a.length;d+=1){if("function"===typeof this[a[d]])this[a[d]](g,b)}else g.setOptions(b)}}};g.fn.tinyMap=function(b){var a=arguments,c=[],d={};return"string"===typeof b?(this.each(function(){d=g.data(this,"tinyMap");d instanceof r&&"function"===typeof d[b]&&(c=d[b].apply(d,Array.prototype.slice.call(a,1)))}),f!==c?c:this):this.each(function(){g.data(this,
"tinyMap")||g.data(this,"tinyMap",new r(this,b))})}})(jQuery,window,document);
