(function(l,q,w,m){function f(c,a){try{return q.hasOwnProperty?c.hasOwnProperty(a.toString()):Object.prototype.hasOwnProperty.call(c,a.toString())}catch(b){}}function n(c,a){var b=[],d=/^[+-]?\d+(\.\d+)?$/,e={lat:"",lng:""};if("string"===typeof c||l.isArray(c))if(b="string"===typeof c?c.replace(/\s+/,"").split(","):c,2===b.length)d.test(b[0])&&d.test(b[1])&&(e.lat=b[0],e.lng=b[1]);else return c;else"object"===typeof c&&(f(c,"x")&&f(c,"y")?(e.lat=c.x,e.lng=c.y):f(c,"lat")&&f(c,"lng")&&(e.lat=c.lat,
e.lng=c.lng));return m!==a&&!0===a?new google.maps.LatLng(e.lat,e.lng):e}function p(c){var a=c.css||"";this.setValues(c);this.span=l("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(a);this.div=l("<div/>").css({position:"absolute",display:"none"});this.span.appendTo(this.div)}function r(c,a){var b={};f(q,"google")&&(b=l.extend({},v,a),this.markerCluster=this.map=null,this._markers=[],this._labels=[],this.container=c,this.options=b,this.interval=parseInt(this.options.interval,
10)||1100,this.googleMapOptions={center:"",control:b.control,disableDoubleClickZoom:b.disableDoubleClickZoom,disableDefaultUI:b.disableDefaultUI,draggable:b.draggable,keyboardShortcuts:b.keyboardShortcuts,mapTypeId:google.maps.MapTypeId[b.mapTypeId.toUpperCase()],mapTypeControl:b.mapTypeControl,mapTypeControlOptions:{position:google.maps.ControlPosition[b.mapTypeControlOptions.position],style:google.maps.MapTypeControlStyle[b.mapTypeControlOptions.style.toUpperCase()]},maxZoom:b.maxZoom,minZoom:b.minZoom,
navigationControl:b.navigationControl,navigationControlOptions:{position:google.maps.ControlPosition[b.navigationControlOptions.position],style:google.maps.NavigationControlStyle[b.navigationControlOptions.style.toUpperCase()]},panControl:b.panControl,panControlOptions:{position:google.maps.ControlPosition[b.panControlOptions.position]},rotateControl:b.rotateControl,scaleControl:b.scaleControl,scaleControlOptions:{position:google.maps.ControlPosition[b.scaleControlOptions.position],style:google.maps.ScaleControlStyle[b.scaleControlOptions.style.toUpperCase()]},
scrollwheel:b.scrollwheel,streetViewControl:b.streetViewControl,streetViewControlOptions:{position:google.maps.ControlPosition[b.streetViewControlOptions.position]},zoom:b.zoom,zoomControl:b.zoomControl,zoomControlOptions:{position:google.maps.ControlPosition[b.zoomControlOptions.position],style:google.maps.ZoomControlStyle[b.zoomControlOptions.style.toUpperCase()]}},this.options.center=this.googleMapOptions.center=n(b.center,!0),!0===b.disableDefaultUI&&(this.googleMapOptions.mapTypeControl=!1,this.googleMapOptions.navigationControl=
!1,this.googleMapOptions.panControl=!1,this.googleMapOptions.rotateControl=!1,this.googleMapOptions.scaleControl=!1,this.googleMapOptions.streetViewControl=!1,this.googleMapOptions.zoomControl=!1),f(b,"styles")&&("string"===typeof b.styles?f(s,b.styles)&&(this.googleMapOptions.styles=s[b.styles]):l.isArray(b.styles)&&(this.googleMapOptions.styles=b.styles)),l(this.container).html(b.loading),this.init())}var v={center:{x:"",y:""},control:!0,disableDoubleClickZoom:!1,disableDefaultUI:!1,draggable:!0,
infoWindowAutoClose:!0,keyboardShortcuts:!0,mapTypeControl:!0,mapTypeControlOptions:{position:"TOP_RIGHT",style:"DEFAULT"},mapTypeId:"ROADMAP",marker:[],markerFitBounds:!1,markerCluster:!1,maxZoom:null,minZoom:null,panControl:!0,panControlOptions:{position:"LEFT_TOP"},polyline:[],navigationControl:!0,navigationControlOptions:{position:"TOP_LEFT",style:"DEFAULT"},scaleControl:!0,scaleControlOptions:{position:"BOTTOM_LEFT",style:"DEFAULT"},scrollwheel:!0,streetViewControl:!0,streetViewControlOptions:{position:"LEFT_TOP"},
zoom:4,zoomControl:!0,zoomControlOptions:{style:"LARGE",position:"LEFT_TOP"},notfound:"\u627e\u4e0d\u5230\u67e5\u8a62\u7684\u5730\u9ede",loading:"\u8b80\u53d6\u4e2d&hellip;",kml:{url:"",viewport:!0,infowindow:!1},interval:100,event:null,showStreetView:!1,autoLocation:!1},t=0,u=0,s={},s={greyscale:[{featureType:"all",stylers:[{saturation:-100},{gamma:.5}]}]};p.prototype=new google.maps.OverlayView;p.prototype.onAdd=function(){var c=this.getPanes().overlayLayer;this.div.appendTo(l(c));this.listeners=
[google.maps.event.addListener(this,"visible_changed",this.onRemove)]};p.prototype.draw=function(){var c=this.getProjection(),a={};try{a=c.fromLatLngToDivPixel(this.get("position")),this.div.css({left:a.x+"px",top:a.y+"px",display:"block"}),this.text&&this.span.html(this.text.toString())}catch(b){}};p.prototype.onRemove=function(){l(this.div).remove()};r.prototype={VERSION:"2.9.0",_polylines:[],_polygons:[],_circles:[],_kmls:[],_directions:[],bounds:new google.maps.LatLngBounds,setZoom:function(c,
a){f(a,"zoom")&&c&&c.setZoom(a.zoom)},kml:function(c,a){var b={},d="",b={};a=a?a:this.options;m!==a.kml&&(b={preserveViewport:!0,suppressInfoWindows:!1},d="string"===typeof a.kml&&0!==a.kml.length?a.kml:m!==a.kml.url?a.kml.url:"",b=new google.maps.KmlLayer(d,l.extend(b,a.kml)),this._kmls.push(b),b.setMap(c))},direction:function(c,a){var b="";a=a?a:this.options;if(f(a,"direction")&&0<a.direction.length)for(b in a.direction)f(a.direction,b)&&this.directionService(a.direction[b])},markers:function(c,
a,b){var d="",e=0,g=0,e="",h=[],k=[];a=a?a:this.options;u=t=0;h=this._markers;if((!b||0===h.length)&&l.isArray(a.marker))for(d in a.marker)f(a.marker,d)&&f(a.marker[d],"addr")&&(e=n(a.marker[d].addr,!0),a.marker[d].addr=e,"string"===typeof e?this.markerByGeocoder(c,a.marker[d],a):this.markerDirect(c,a.marker[d],a));if("modify"===b)for(k=this._labels,e=0;e<a.marker.length;e+=1)if(f(a.marker[e],"id")){for(g=0;g<h.length;g+=1)a.marker[e].id===h[g].id&&f(a.marker[e],"addr")&&(h[g].setPosition(new google.maps.LatLng(a.marker[e].addr[0],
a.marker[e].addr[1])),f(a.marker[e],"text")&&(f(h[g],"infoWindow")?"function"===typeof h[g].infoWindow.setContent&&h[g].infoWindow.setContent(a.marker[e].text):(h[g].infoWindow=new google.maps.InfoWindow({content:a.marker[e].text}),this.bindEvents(h[g],a.marker[e].event))),f(a.marker[e],"icon")&&h[g].setIcon(a.marker[e].icon));for(g=0;g<k.length;g+=1)a.marker[e].id===k[g].id&&(f(a.marker[e],"label")&&(k[g].text=a.marker[e].label),k[g].draw())}else f(a.marker[e],"addr")&&(a.marker[e].addr=n(a.marker[e].addr,
!0),"string"===typeof a.marker[e].addr?this.markerByGeocoder(c,a.marker[e]):this.markerDirect(c,a.marker[e]));if(f(a,"markerCluster")&&!0===a.markerCluster&&"function"===typeof MarkerClusterer)return new MarkerClusterer(c,this._markers)},drawPolyline:function(c,a){var b={},d=0,e="",g={},h=0,k=new google.maps.MVCArray,l=[],g={},n=[],p={};a=a?a:this.options;if(f(a,"polyline")&&f(a.polyline,"coords")){for(e in a.polyline.coords)f(a.polyline.coords,e)&&(g=a.polyline.coords,m!==g[e]&&k.push(new google.maps.LatLng(g[e][0],
g[e][1])));b=new google.maps.Polyline({strokeColor:a.polyline.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polyline.width||2});this._polylines.push(b);if(2<k.getLength())for(d=0;d<k.length;d+=1)0<d&&k.getLength()-1>d&&n.push({location:k[d],stopover:!1});!0===a.polyline.snap?(g=new google.maps.DirectionsService,g.route({origin:k.getAt(0),waypoints:n,destination:k.getAt(k.getLength()-1),travelMode:google.maps.DirectionsTravelMode.DRIVING},function(c,e){if(e===google.maps.DirectionsStatus.OK){d=0;
for(h=c.routes[0].overview_path.length;d<h;d+=1)l.push(c.routes[0].overview_path[d]);b.setPath(l);"function"===typeof a.polyline.getDistance&&(p=c.routes[0].legs[0].distance,a.polyline.getDistance.call(this,p))}})):(b.setPath(k),f(google.maps.geometry,"spherical")&&"function"===typeof google.maps.geometry.spherical.computeDistanceBetween&&(p=google.maps.geometry.spherical.computeDistanceBetween(k.getAt(0),k.getAt(k.getLength()-1)),"function"===typeof a.polyline.getDistance&&a.polyline.getDistance.call(this,
p)));b.setMap(c)}},drawPolygon:function(c,a){var b={},b="",d={},e=[];a=a?a:this.options;if(f(a,"polygon")&&f(a.polygon,"coords")){for(b in a.polygon.coords)f(a.polygon.coords,b)&&(d=a.polygon.coords,m!==d[b]&&e.push(new google.maps.LatLng(d[b][0],d[b][1])));b=new google.maps.Polygon({path:e,strokeColor:a.polygon.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polygon.width||2,fillColor:a.polygon.fillcolor||"#CC0000",fillOpacity:.35});this._polygons.push(b);b.setMap(this.map);"function"===typeof a.polygon.click&&
google.maps.event.addListener(b,"click",a.polygon.click)}},drawCircle:function(c,a){var b=0,d={lat:"",lng:""},e={},e={};a=a?a:this.options;if(f(a,"circle")&&l.isArray(a.circle))for(b=a.circle.length-1;0<=b;b-=1)e=a.circle[b],f(e,"center")&&(d=n(e.center)),d.lat&&d.lng&&(e=new google.maps.Circle({strokeColor:e.color||"#FF0000",strokeOpacity:e.opacity||.8,strokeWeight:e.width||2,fillColor:e.fillcolor||"#FF0000",fillOpacity:e.fillopacity||.35,map:this.map,center:new google.maps.LatLng(d.lat,d.lng),radius:e.radius||
10,zIndex:100,id:f(a,"id")?a.id:""}),this._circles.push(e),"function"===typeof a.circle[b].click&&google.maps.event.addListener(e,"click",a.circle[b].click))},overlay:function(){var c=this.map,a=this.options;try{this.kml(c,a),this.direction(c,a),this.markers(c,a),this.drawPolyline(c,a),this.drawPolygon(c,a),this.drawCircle(c,a),this.streetView(c,a),this.geoLocation(c,a)}catch(b){console.dir(b)}},markerIcon:function(c){var a={};if(f(c,"icon")){if("string"===typeof c.icon)return c.icon;f(c.icon,"url")&&
(a.url=c.icon.url);f(c.icon,"size")&&m!==c.icon.size[0]&&m!==c.icon.size[1]&&(a.scaledSize=new google.maps.Size(c.icon.size[0],c.icon.size[1]));f(c.icon,"anchor")&&m!==c.icon.anchor[0]&&m!==c.icon.anchor[1]&&(a.anchor=new google.maps.Point(c.icon.anchor[0],c.icon.anchor[1]))}return a},markerDirect:function(c,a){var b={},d={},d={},d=f(a,"id")?a.id:"",b=f(a,"title")?a.title.toString().replace(/<([^>]+)>/g,""):!1,e=f(a,"text")?a.text.toString():!1,g={map:c,position:a.addr,animation:null,id:d},h=this.markerIcon(a);
b&&(g.title=b);e&&(g.text=e,g.infoWindow=new google.maps.InfoWindow({content:e}));if("string"===typeof h||f(h,"url"))g.icon=h;f(a.animation)&&"string"===typeof a.animation&&(g.animation=google.maps.Animation[a.animation.toUpperCase()]);b=new google.maps.Marker(g);this._markers.push(b);f(b,"position")&&(b.getPosition().lat()&&b.getPosition().lng()&&this.bounds.extend(b.position),!0===this.options.markerFitBounds&&this._markers.length===this.options.marker.length&&c.fitBounds(this.bounds));!0===this.options.markerCluster&&
"function"===typeof MarkerClusterer&&t===this.options.marker.length?this.markerCluster=new MarkerClusterer(c,this._markers):(d={map:c,css:m!==a.css?a.css:"",id:d},"string"===typeof a.label&&0!==a.label.length&&(d.text=a.label,d=new p(d),d.bindTo("position",b,"position"),d.bindTo("text",b,"position"),d.bindTo("visible",b),this._labels.push(d)),this.bindEvents(b,a.event))},markerByGeocoder:function(c,a){var b=this;(new google.maps.Geocoder).geocode({address:a.addr},function(d,e){if(e===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)q.setTimeout(function(){b.markerByGeocoder(c,
a)},b.interval);else if(e===google.maps.GeocoderStatus.OK){var g={},h={},h={},k=f(a,"id")?a.id:"",g=f(a,"title")?a.title.toString().replace(/<([^>]+)>/g,""):!1,h=f(a,"text")?a.text.toString():!1,k={map:c,position:d[0].geometry.location,animation:null,id:k},l=b.markerIcon(a);g&&(k.title=g);h&&(k.text=h,k.infoWindow=new google.maps.InfoWindow({content:h}));if("string"===typeof l||f(l,"url"))k.icon=l;f(a,"animation")&&"string"===typeof a.animation&&(k.animation=google.maps.Animation[a.animation.toUpperCase()]);
g=new google.maps.Marker(k);b._markers.push(g);f(g,"position")&&g.getPosition().lat()&&g.getPosition().lng()&&b.bounds.extend(k.position);!0===b.options.markerFitBounds&&b._markers.length===b.options.marker.length&&c.fitBounds(b.bounds);f(b.options,"markerCluster")&&"function"===typeof MarkerClusterer&&u===b.options.marker.length?b.markerCluster=new MarkerClusterer(c,b._markers):(h={map:b.map,css:a.css||""},"string"===typeof a.label&&0!==a.label.length&&(h.text=a.label,h=new p(h),h.bindTo("position",
g,"position"),h.bindTo("text",g,"position"),h.bindTo("visible",g),b._labels.push(h)),b.bindEvents(g,a.event))}})},directionService:function(c){var a=[],b=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer,e={travelMode:google.maps.DirectionsTravelMode.DRIVING,optimizeWaypoints:c.optimize||!1},g={},h=0,k=0;e.origin=n(c.from,!0);e.destination=n(c.to,!0);"string"===typeof c.travel&&c.travel.length&&(e.travelMode=google.maps.TravelMode[c.travel.toUpperCase()]);g=l(m!==c.panel?c.panel:
null);if(m!==c.waypoint&&0!==c.waypoint){h=0;for(k=c.waypoint.length;h<k;h+=1)a.push({location:n(c.waypoint[h],!0),stopover:!0});e.waypoints=a}m!==e.origin&&m!==e.destination&&(b.route(e,function(a,b){b===google.maps.DirectionsStatus.OK&&(f(c,"autoViewport")&&d.setOptions({preserveViewport:!1===c.autoViewport?!0:!1}),d.setDirections(a))}),d.setMap(this.map),g.length&&d.setPanel(g.get(0)),this._directions.push(d))},bindEvents:function(c,a){var b=this,d={};switch(typeof a){case "function":google.maps.event.addListener(c,
"click",a);break;case "object":for(d in a)"function"===typeof a[d]?google.maps.event.addListener(c,d,a[d]):f(a[d],"func")&&"function"===typeof a[d].func?f(a[d],"once")&&!0===a[d].once?google.maps.event.addListenerOnce(c,d,a[d].func):google.maps.event.addListener(c,d,a[d].func):"function"===typeof a[d]&&google.maps.event.addListener(c,d,a[d])}f(c,"infoWindow")&&google.maps.event.addListener(c,"click",function(){var a=0,d={};if(f(b.options,"infoWindowAutoClose")&&!0===b.options.infoWindowAutoClose)for(a=
0;a<b._markers.length;a+=1)d=b._markers[a],m!==d.infoWindow&&"function"===typeof d.infoWindow.close&&d.infoWindow.close();c.infoWindow.open(b.map,c)})},streetView:function(c,a){var b=c.getStreetView();b.setPosition(c.getCenter());f(a,"showStreetView")&&b.setVisible(a.showStreetView)},panto:function(c){var a="",a={},b=this.map;f(this,"map")&&null!==b&&m!==b&&(a=n(c,!0),"string"===typeof c?(a=new google.maps.Geocoder,a.geocode({address:c},function(a,c){c===google.maps.GeocoderStatus.OK&&"function"===
typeof b.panTo&&m!==a[0]&&b.panTo(a[0].geometry.location)})):"function"===typeof b.panTo&&b.panTo(a))},clear:function(c){for(var a=[],b="",d=0,e=0,a="string"===typeof c?c.split(","):l.isArray(c)?c:[],a=a.length?a:"marker circle polygon polyline direction kml".split(" "),d=0;d<a.length;d+=1)if(b="_"+l.trim(a[d].toString().toLowerCase())+"s",m!==this[b]&&this[b].length){for(e=0;e<this[b].length;e+=1)this.map===this[b][e].getMap()&&(this[b][e].set("visible",!1),this[b][e].set("directions",null),this[b][e].setMap(null));
this[b].length=0}},modify:function(c){var a=[],b=[["kml","kml"],["marker","markers"],["direction","direction"],["polyline","drawPolyline"],["polygon","drawPolygon"],["circle","drawCircle"],["zoom","setZoom"],["showStreetView","streetView"]],d=0,e=this.map;if(m!==c){for(d=0;d<b.length;d+=1)f(c,b[d][0])&&a.push(b[d][1]);if(null!==e)if(a.length)for(d=0;d<a.length;d+=1){if("function"===typeof this[a[d]])this[a[d]](e,c,"modify")}else e.setOptions(c)}},geoLocation:function(c,a){var b={maximumAge:6E5,timeout:3E3,
enableHighAccuracy:!1},d=navigator.geolocation;d&&!0===a.autoLocation&&d.getCurrentPosition(function(a){a&&c.panTo(new google.maps.LatLng(a.coords.latitude,a.coords.longitude))},function(a){},b)},init:function(){var c=this,a={},b={},d="";"string"===typeof c.options.center?(b=new google.maps.Geocoder,b.geocode({address:c.options.center},function(b,g){try{g===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?c.init():g===google.maps.GeocoderStatus.OK&&0!==b.length?(c.googleMapOptions.center=g===google.maps.GeocoderStatus.OK&&
0!==b.length?b[0].geometry.location:"",c.map=new google.maps.Map(c.container,c.googleMapOptions),google.maps.event.addListenerOnce(c.map,"idle",function(){c.overlay()}),c.bindEvents(c.map,c.options.event)):(d=c.options.notfound.text||g,a.html(d.replace(/</g,"&lt;").replace(/>/g,"&gt;")))}catch(f){a.html((m!==f.message?f.message:f.description).toString())}})):(c.map=new google.maps.Map(c.container,c.googleMapOptions),google.maps.event.addListenerOnce(c.map,"idle",function(){c.overlay()}),c.bindEvents(c.map,
c.options.event))}};l.fn.tinyMap=function(c){var a=arguments,b=[],d={};return"string"===typeof c?(this.each(function(){d=l.data(this,"tinyMap");d instanceof r&&"function"===typeof d[c]&&(b=d[c].apply(d,Array.prototype.slice.call(a,1)))}),m!==b?b:this):this.each(function(){l.data(this,"tinyMap")||l.data(this,"tinyMap",new r(this,c))})}})(jQuery,window,document);
