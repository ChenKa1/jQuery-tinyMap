(function(h,m,r,e){function f(b,a){try{return m.hasOwnProperty?b.hasOwnProperty(a.toString()):Object.prototype.hasOwnProperty.call(b,a.toString())}catch(c){}}function l(b){var a=b.css||"";this.setValues(b);this.span=h("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(a);this.div=h("<div/>").css({position:"absolute",display:"none"});this.span.appendTo(this.div)}function n(b,a){f(m,"google")&&(this.map=null,this.container=b,this.options=h.extend({},q,a),this.interval=
parseInt(this.options.interval,10),this.interval=isNaN(this.interval)?200:this.interval,this.GoogleMapOptions={center:new google.maps.LatLng(this.options.center.x,this.options.center.y),control:this.options.control,disableDefaultUI:this.options.disableDefaultUI,draggable:this.options.draggable,keyboardShortcuts:this.options.keyboardShortcuts,mapTypeId:google.maps.MapTypeId[this.options.mapTypeId.toUpperCase()],mapTypeControl:this.options.mapTypeControl,mapTypeControlOptions:{position:google.maps.ControlPosition[this.options.mapTypeControlOptions.position],
style:google.maps.MapTypeControlStyle[this.options.mapTypeControlOptions.style.toUpperCase()]},maxZoom:this.options.maxZoom,minZoom:this.options.minZoom,navigationControl:this.options.navigationControl,navigationControlOptions:{position:google.maps.ControlPosition[this.options.navigationControlOptions.position],style:google.maps.NavigationControlStyle[this.options.navigationControlOptions.style.toUpperCase()]},panControl:this.options.panControl,panControlOptions:{position:google.maps.ControlPosition[this.options.panControlOptions.position]},
rotateControl:this.options.rotateControl,scaleControl:this.options.scaleControl,scaleControlOptions:{position:google.maps.ControlPosition[this.options.scaleControlOptions.position],style:google.maps.ScaleControlStyle[this.options.scaleControlOptions.style.toUpperCase()]},scrollwheel:this.options.scrollwheel,streetViewControl:this.options.streetViewControl,streetViewControlOptions:{position:google.maps.ControlPosition[this.options.streetViewControlOptions.position]},zoom:this.options.zoom,zoomControl:this.options.zoomControl,
zoomControlOptions:{position:google.maps.ControlPosition[this.options.zoomControlOptions.position],style:google.maps.ZoomControlStyle[this.options.zoomControlOptions.style.toUpperCase()]}},h(this.container).html(this.options.loading),this.init())}var p=0,q={center:{x:"24",y:"121"},control:!0,disableDefaultUI:!1,draggable:!0,keyboardShortcuts:!0,mapTypeControl:!0,mapTypeControlOptions:{position:"TOP_RIGHT",style:"DEFAULT"},mapTypeId:"ROADMAP",marker:[],markerFitBounds:!1,maxZoom:null,minZoom:null,
panControl:!0,panControlOptions:{position:"LEFT_TOP"},polyline:[],navigationControl:!0,navigationControlOptions:{position:"TOP_LEFT",style:"DEFAULT"},scaleControl:!0,scaleControlOptions:{position:"BOTTOM_LEFT",style:"DEFAULT"},scrollwheel:!0,streetViewControl:!0,streetViewControlOptions:{position:"LEFT_TOP"},zoom:4,zoomControl:!0,zoomControlOptions:{style:"LARGE",position:"LEFT_TOP"},notfound:"\u627e\u4e0d\u5230\u67e5\u8a62\u7684\u5730\u9ede",loading:"\u8b80\u53d6\u4e2d\u2026",kml:{url:"",viewport:!0,
infowindow:!1},interval:200};l.prototype=new google.maps.OverlayView;l.prototype.onAdd=function(){var b=this.getPanes().overlayLayer;this.div.appendTo(h(b));this.listeners=[google.maps.event.addListener(this,"visible_changed",this.onRemove)]};l.prototype.draw=function(){var b=this.getProjection().fromLatLngToDivPixel(this.get("position"));this.div.css({left:b.x+"px",top:b.y+"px",display:"block"});this.text&&this.span.html(this.text.toString())};l.prototype.onRemove=function(){h(this.div).remove()};
n.prototype={VERSION:"2.5.6",_markers:[],_labels:[],_polylines:[],_polygons:[],_circles:[],_kmls:[],_directions:[],bounds:new google.maps.LatLngBounds,setZoom:function(b,a){f(a,"zoom")&&b&&b.setZoom(a.zoom)},kml:function(b,a){a=a?a:this.options;var c={},d="",c={};e!==a.kml&&(c={preserveViewport:!0,suppressInfoWindows:!1},d="string"===typeof a.kml&&0!==a.kml.length?a.kml:e!==a.kml.url?a.kml.url:"",c=new google.maps.KmlLayer(d,h.extend(c,a.kml)),this._kmls.push(c),c.setMap(b))},direction:function(b,
a){var c="";a=a?a:this.options;if(e!==a.direction&&0<a.direction.length)for(c in a.direction)f(a.direction,c)&&e!==a.direction[c]&&this.DirectionService(a.direction[c])},markers:function(b,a){var c="";a=a?a:this.options;if(e!==a.marker&&0<a.marker.length)for(c in a.marker)f(a.marker,c)&&f(a.marker[c],"addr")&&("object"===typeof a.marker[c].addr?2===a.marker[c].addr.length&&this.MarkerDirect(a.marker[c]):this.MarkerByGeocoder(a.marker[c]))},DrawPolyline:function(b,a){var c={},c="",d={},k=[];a=a?a:
this.options;if(e!==a.polyline&&e!==a.polyline.coords){for(c in a.polyline.coords)f(a.polyline.coords,c)&&(d=a.polyline.coords,e!==d[c]&&k.push(new google.maps.LatLng(d[c][0],d[c][1])));c=new google.maps.Polyline({path:k,strokeColor:a.polyline.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polyline.width||2});this._polylines.push(c);c.setMap(b)}},DrawPolygon:function(b,a){var c={},c="",d={},k=[];a=a?a:this.options;if(e!==a.polygon&&e!==a.polygon.coords){for(c in a.polygon.coords)f(a.polygon.coords,
c)&&(d=a.polygon.coords,e!==d[c]&&k.push(new google.maps.LatLng(d[c][0],d[c][1])));c=new google.maps.Polygon({path:k,strokeColor:a.polygon.color||"#FF0000",strokeOpacity:1,strokeWeight:a.polygon.width||2,fillColor:a.polygon.fillcolor||"#CC0000",fillOpacity:0.35});this._polygons.push(c);c.setMap(this.map);h.isFunction(a.polygon.click)&&google.maps.event.addListener(c,"click",a.polygon.click)}},DrawCircle:function(b,a){var c=0,d={},d={};a=a?a:this.options;if(e!==a.circle&&0<a.circle.length)for(c=a.circle.length-
1;0<=c;c-=1)d=a.circle[c],e!==d.center.x&&e!==d.center.y&&(d=new google.maps.Circle({strokeColor:d.color||"#FF0000",strokeOpacity:d.opacity||0.8,strokeWeight:d.width||2,fillColor:d.fillcolor||"#FF0000",fillOpacity:d.fillopacity||0.35,map:this.map,center:new google.maps.LatLng(d.center.x,d.center.y),radius:d.radius||10,zIndex:100}),this._circles.push(d),h.isFunction(a.circle[c].click)&&google.maps.event.addListener(d,"click",a.circle[c].click))},overlay:function(){this.kml(this.map);this.direction(this.map);
this.markers(this.map);this.DrawPolyline(this.map);this.DrawPolygon(this.map);this.DrawCircle(this.map)},MarkerDirect:function(b){var a,c;c={map:this.map,position:new google.maps.LatLng(b.addr[0],b.addr[1]),title:b.text.replace(/<([^>]+)>/g,""),infoWindow:new google.maps.InfoWindow({content:b.text})};a={};a={};"string"===typeof b.icon?c.icon=b.icon:f(b.icon,"url")&&(a=f(b.icon,"anchor")&&e!==b.icon.anchor[1]?new google.maps.Point(b.icon.anchor[0],b.icon.anchor[1]):new google.maps.Point(0,0),a=new google.maps.MarkerImage(b.icon.url,
null,new google.maps.Point(0,0),a),c.icon=a);a=new google.maps.Marker(c);this._markers.push(a);f(a,"position")&&a.getPosition().lat()&&a.getPosition().lng()&&this.bounds.extend(c.position);c={map:this.map,css:e!==b.css?b.css:""};"string"===typeof b.label&&0!==b.label.length&&(c.text=b.label);c=new l(c);c.bindTo("position",a,"position");c.bindTo("text",a,"position");c.bindTo("visible",a);this.bindEvent(a,b.event)},MarkerByGeocoder:function(b){var a=new google.maps.Geocoder,c=this;-1!==b.addr.indexOf(",")&&
(b.addr="loc: "+b.addr);a.geocode({address:b.addr},function(a,k){if(k===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)m.setTimeout(function(){c.MarkerByGeocoder(b)},this.interval);else if(k===google.maps.GeocoderStatus.OK){var e,g;g={map:c.map,position:a[0].geometry.location,title:b.text.replace(/<([^>]+)>/g,""),infoWindow:new google.maps.InfoWindow({content:b.text})};"string"===typeof b.icon&&(g.icon=b.icon);e=new google.maps.Marker(g);c._markers.push(e);f(e,"position")&&e.getPosition().lat()&&e.getPosition().lng()&&
c.bounds.extend(g.position);g={map:c.map,css:b.css||""};"string"===typeof b.label&&0!==b.label.length&&(g.text=b.label);g=new l(g);g.bindTo("position",e,"position");g.bindTo("text",e,"position");g.bindTo("visible",e);c.bindEvent(e,b.event)}})},DirectionService:function(b){var a=[],c=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer,k={travelMode:google.maps.DirectionsTravelMode.DRIVING,optimizeWaypoints:b.optimize||!1},f=0,g=0;"string"===typeof b.from&&(k.origin=b.from);"string"===
typeof b.to&&(k.destination=b.to);"string"===typeof b.travel&&0<b.travel.length&&(k.travelMode=google.maps.DirectionsTravelMode[b.travel.toUpperCase()]);if(e!==b.waypoint&&0!==b.waypoint){f=0;for(g=b.waypoint.length;f<g;f+=1)a.push({location:b.waypoint[f].toString(),stopover:!0});k.waypoints=a}e!==k.origin&&e!==k.destination&&(c.route(k,function(b,a){a===google.maps.DirectionsStatus.OK&&d.setDirections(b)}),d.setMap(this.map),this._directions.push(d))},bindEvent:function(b,a){var c=this;"function"===
typeof a?google.maps.event.addListener(b,"click",a):f(a,"type")?"string"===typeof a.type&&"function"===typeof a.bind&&google.maps.event.addListener(b,a.type,a.bind):google.maps.event.addListener(b,"click",function(){b.infoWindow.open(c.map,b)})},init:function(){var b=this,a={};p+=1;"string"===typeof this.options.center?m.setTimeout(function(){var c=h(b.container),d="";-1!==b.options.center.indexOf(",")&&(b.options.center="loc: "+b.options.center);a=new google.maps.Geocoder;a.geocode({address:b.options.center},
function(a,f){try{f===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?b.init():f===google.maps.GeocoderStatus.OK&&0!==a.length?(b.GoogleMapOptions.center=f===google.maps.GeocoderStatus.OK&&0!==a.length?a[0].geometry.location:"",b.map=new google.maps.Map(b.container,b.GoogleMapOptions),google.maps.event.addListenerOnce(b.map,"idle",function(){b.overlay();b.options.marker.length&&!0===b.options.markerFitBounds&&setTimeout(function(){b.map.fitBounds(b.bounds)},this.interval)})):(d=b.options.notfound.text||
f,c.html(d.replace(/</g,"&lt;").replace(/>/g,"&gt;")))}catch(g){c.html((e!==g.message?g.message:g.description).toString())}})},this.interval*p):(b.map=new google.maps.Map(b.container,b.GoogleMapOptions),google.maps.event.addListenerOnce(b.map,"idle",function(){b.overlay();b.options.marker.length&&!0===b.options.markerFitBounds&&b.map.fitBounds(b.bounds)}))},panto:function(b){var a=this,c="",d={};f(a,"map")&&null!==a.map&&e!==a.map&&("string"===typeof b?(-1!==b.indexOf(",")&&(c="loc: "+b),d=new google.maps.Geocoder,
d.geocode({address:b},function(b,c){c===google.maps.GeocoderStatus.OK&&h.isFunction(a.map.panTo)&&e!==b[0]&&a.map.panTo(b[0].geometry.location)})):("[object Array]"===Object.prototype.toString.call(b)?2===b.length&&(c=new google.maps.LatLng(b[0],b[1])):f(b,"lat")&&f(b,"lng")?c=new google.maps.LatLng(b.lat,b.lng):f(b,"x")&&f(b,"y")&&(c=new google.maps.LatLng(b.x,b.y)),h.isFunction(a.map.panTo)&&e!==c&&a.map.panTo(c)))},clear:function(b){var a=[],c="",d=0,f=0;"string"===typeof b&&(a=b.split(","));for(d=
0;d<a.length;d+=1)if(c="_"+h.trim(a[d].toString().toLowerCase())+"s",e!==this[c]&&this[c].length){for(f=0;f<this[c].length;f+=1)this.map===this[c][f].getMap()&&(this[c][f].set("visible",!1),this[c][f].setMap(this.map,null));this[c]=[]}},modify:function(b){var a=[],c=[["kml","kml"],["marker","markers"],["direction","direction"],["polyline","DrawPolyline"],["polygon","DrawPolygon"],["circle","DrawCircle"],["zoom","setZoom"]],d;if(e!==b){for(d=0;d<c.length;d+=1)f(b,c[d][0])&&a.push(c[d][1]);if(null!==
this.map&&e!==this.map&&a)for(d=0;d<a.length;d+=1)if("function"===typeof this[a[d]])this[a[d]](this.map,b)}}};h.fn.tinyMap=function(b){var a=arguments,c=[],d={};return"string"===typeof b?(this.each(function(){d=h.data(this,"tinyMap");d instanceof n&&"function"===typeof d[b]&&(c=d[b].apply(d,Array.prototype.slice.call(a,1)))}),e!==c?c:this):this.each(function(){h.data(this,"tinyMap")||h.data(this,"tinyMap",new n(this,b))})}})(jQuery,window,document);
